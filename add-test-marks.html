<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Test Marks - Quick Setup</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-lg p-8 max-w-2xl w-full">
        <h1 class="text-3xl font-bold text-blue-700 mb-4">Quick Test Marks Setup</h1>
        <p class="text-gray-600 mb-6">Click the button below to add sample marks for testing the student portal.</p>
        
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
            <h3 class="font-semibold text-blue-800 mb-2">What This Does:</h3>
            <ul class="text-sm text-blue-700 space-y-1">
                <li>✅ Adds sample marks for <strong>L4 SWD</strong> class</li>
                <li>✅ Adds sample marks for <strong>S1A, S1B, S2A</strong> classes</li>
                <li>✅ Includes marks for "SHYAKA CLEVER PRINCE" and other students</li>
                <li>✅ All 3 midterms populated with test data</li>
                <li>✅ Data saved to localStorage instantly</li>
            </ul>
        </div>

        <button id="addMarksBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-lg transition mb-4">
            Add Test Marks to System
        </button>

        <button id="clearMarksBtn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition mb-6">
            Clear All Marks (Reset)
        </button>

        <div id="status" class="hidden p-4 rounded-lg mb-4"></div>

        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <h3 class="font-semibold text-gray-800 mb-3">Next Steps:</h3>
            <ol class="text-sm text-gray-700 space-y-2">
                <li><strong>1.</strong> Click "Add Test Marks to System" above</li>
                <li><strong>2.</strong> Open <code class="bg-gray-200 px-2 py-1 rounded">student-data.html</code></li>
                <li><strong>3.</strong> Login as: <strong>shyaka clever prince</strong> / Class: <strong>L4 SWD</strong></li>
                <li><strong>4.</strong> Click "View Midterm Marks" to see your test marks!</li>
            </ol>
        </div>

        <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <h3 class="font-semibold text-yellow-800 mb-2">Sample Students Added:</h3>
            <div class="text-sm text-yellow-700 space-y-1">
                <div><strong>L4 SWD:</strong> SHYAKA CLEVER PRINCE, MUGISHA Jean, UWASE Marie</div>
                <div><strong>S1A:</strong> ABIMANA HIRWA Gary Blessing, ABEREYIMANA James</div>
                <div><strong>S1B:</strong> ABAYISENGA Emmu Shalom, AMANI NSHUTI Claver</div>
                <div><strong>S2A:</strong> BYISHIMO Remy, BAHO AKARIZA Kevine</div>
            </div>
        </div>
    </div>

    <script>
        const addMarksBtn = document.getElementById('addMarksBtn');
        const clearMarksBtn = document.getElementById('clearMarksBtn');
        const status = document.getElementById('status');

        function showStatus(message, type) {
            status.className = `p-4 rounded-lg mb-4 ${type === 'success' ? 'bg-green-50 border border-green-200 text-green-700' : 'bg-red-50 border border-red-200 text-red-700'}`;
            status.textContent = message;
            status.classList.remove('hidden');
            
            setTimeout(() => {
                status.classList.add('hidden');
            }, 5000);
        }

        addMarksBtn.addEventListener('click', function() {
            // Sample marks data for testing
            const testMarks = {
                "L4 SWD": {
                    "midterm1": {
                        "SHYAKA CLEVER PRINCE": "85",
                        "MUGISHA Jean": "78",
                        "UWASE Marie": "92"
                    },
                    "midterm2": {
                        "SHYAKA CLEVER PRINCE": "88",
                        "MUGISHA Jean": "82",
                        "UWASE Marie": "95"
                    },
                    "midterm3": {
                        "SHYAKA CLEVER PRINCE": "90",
                        "MUGISHA Jean": "85",
                        "UWASE Marie": "93"
                    }
                },
                "S1A": {
                    "midterm1": {
                        "ABIMANA HIRWA Gary Blessing": "87",
                        "ABEREYIMANA James": "75",
                        "AHISHAKIYE MANZI Aime Miguel": "82"
                    },
                    "midterm2": {
                        "ABIMANA HIRWA Gary Blessing": "90",
                        "ABEREYIMANA James": "78",
                        "AHISHAKIYE MANZI Aime Miguel": "85"
                    },
                    "midterm3": {
                        "ABIMANA HIRWA Gary Blessing": "92",
                        "ABEREYIMANA James": "80",
                        "AHISHAKIYE MANZI Aime Miguel": "88"
                    }
                },
                "S1B": {
                    "midterm1": {
                        "ABAYISENGA Emmu Shalom": "83",
                        "AMANI NSHUTI Claver": "76",
                        "ARERWENEZA Laetitia": "88"
                    },
                    "midterm2": {
                        "ABAYISENGA Emmu Shalom": "86",
                        "AMANI NSHUTI Claver": "79",
                        "ARERWENEZA Laetitia": "91"
                    },
                    "midterm3": {
                        "ABAYISENGA Emmu Shalom": "89",
                        "AMANI NSHUTI Claver": "82",
                        "ARERWENEZA Laetitia": "94"
                    }
                },
                "S2A": {
                    "midterm1": {
                        "BYISHIMO Remy": "80",
                        "BAHO AKARIZA Kevine": "85",
                        "DUKUZUMUREMYI Janvier": "77"
                    },
                    "midterm2": {
                        "BYISHIMO Remy": "83",
                        "BAHO AKARIZA Kevine": "88",
                        "DUKUZUMUREMYI Janvier": "80"
                    },
                    "midterm3": {
                        "BYISHIMO Remy": "86",
                        "BAHO AKARIZA Kevine": "91",
                        "DUKUZUMUREMYI Janvier": "83"
                    }
                }
            };

            try {
                // Save to localStorage with both keys
                localStorage.setItem('publishedMarks', JSON.stringify(testMarks));
                localStorage.setItem('kageyoMarks', JSON.stringify(testMarks));
                
                // Set publish timestamp
                localStorage.setItem('publishTimestamp', new Date().toISOString());
                localStorage.setItem('marksPublished', 'true');
                
                showStatus('✅ Test marks added successfully! You can now login to student-data.html and view marks.', 'success');
                
                // Log for debugging
                console.log('Test marks added:', testMarks);
                console.log('Total classes:', Object.keys(testMarks).length);
                console.log('Total students with marks:', Object.values(testMarks).reduce((acc, classData) => {
                    return acc + Object.keys(classData.midterm1 || {}).length;
                }, 0));
            } catch (error) {
                showStatus('❌ Error adding marks: ' + error.message, 'error');
                console.error('Error:', error);
            }
        });

        clearMarksBtn.addEventListener('click', function() {
            if (confirm('Are you sure you want to clear all marks? This will reset the entire system.')) {
                try {
                    localStorage.removeItem('publishedMarks');
                    localStorage.removeItem('kageyoMarks');
                    localStorage.removeItem('publishedExamData');
                    localStorage.removeItem('kageyoExamData');
                    localStorage.removeItem('publishTimestamp');
                    localStorage.removeItem('marksPublished');
                    
                    showStatus('✅ All marks cleared successfully! System has been reset.', 'success');
                    console.log('All marks cleared from localStorage');
                } catch (error) {
                    showStatus('❌ Error clearing marks: ' + error.message, 'error');
                    console.error('Error:', error);
                }
            }
        });

        // Check if marks already exist
        window.addEventListener('load', function() {
            const existingMarks = localStorage.getItem('publishedMarks');
            if (existingMarks) {
                const marksData = JSON.parse(existingMarks);
                const classCount = Object.keys(marksData).length;
                if (classCount > 0) {
                    status.className = 'p-4 rounded-lg mb-4 bg-blue-50 border border-blue-200 text-blue-700';
                    status.textContent = `ℹ️ System already has marks for ${classCount} class(es). Click "Add Test Marks" to overwrite or "Clear All Marks" to reset.`;
                    status.classList.remove('hidden');
                }
            }
        });
    </script>
</body>
</html>
