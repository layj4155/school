<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Detailed news articles from Kageyo TVET School, located in Gicumbi district, Kaniga sector.">
    <meta name="author" content="jobeuse| yobu| job| iradukunda">
    <title>Kageyo TVET School | News Article</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="images/LOGO-KAGEYO-TVET.png" rel="icon">
    <style>
        .dropdown-menu {
            display: none;
            transition: all 0.3s ease-in-out;
            z-index: 1000;
        }
        .dropdown-menu.active {
            display: block;
        }
        @media (min-width: 769px) {
            .dropdown-menu {
                position: absolute;
                background-color: #ffffff;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                border-radius: 0.375rem;
                min-width: 12rem;
                top: 100%;
                left: 0;
            }
        }
        @media (max-width: 768px) {
            #loader {
                position: absolute;
                left: 50%;
                top: 50%;
                z-index: 1;
                transform: translate(-50%, -50%);
            }
            .dropdown-menu {
                position: static;
                box-shadow: none;
                background-color: #f3f4f6;
                width: 100%;
                display: none;
            }
            .dropdown-menu.active {
                display: block;
            }
        }
        :focus {
            outline: 3px solid #1D4ED8;
            outline-offset: 2px;
        }
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }
        #chatbot-window {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 360px;
            max-height: 480px;
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1000;
            overflow: hidden;
        }
        #chatbot-window.active {
            display: block;
        }
        #chatbot-messages {
            height: 360px;
            overflow-y: auto;
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }
        #chatbot-input {
            width: 100%;
            padding: 0.75rem;
            border: none;
            outline: none;
            font-size: 1rem;
        }
        #chatbot-input:focus {
            outline: 2px solid #1D4ED8;
        }
        #chatbot-header {
            background-color: #1D4ED8;
            color: white;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chatbot-user-message {
            background-color: #e3f2fd;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            margin: 0.5rem 0;
            max-width: 80%;
            align-self: flex-end;
        }
        .chatbot-bot-message {
            background-color: #f3f4f6;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            margin: 0.5rem 0;
            max-width: 80%;
        }
        .chatbot-link {
            color: #1D4ED8;
            text-decoration: underline;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 1s ease-in;
        }
        /* Admin Panel Styles */
        #admin-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1001;
            width: 90%;
            max-width: 500px;
        }
        #admin-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .admin-active #admin-panel,
        .admin-active #admin-overlay {
            display: block;
        }
        /* Related News Styles */
        .related-news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        .related-news-card {
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #e5e7eb;
        }
        .related-news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        .related-news-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        .related-news-content {
            padding: 1.25rem;
        }
        .related-news-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 0.5rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .related-news-date {
            color: #6b7280;
            font-size: 0.8rem;
            margin-bottom: 0.75rem;
        }
        .related-news-excerpt {
            color: #4b5563;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .read-more-small {
            color: #1e40af;
            font-weight: 600;
            text-decoration: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            transition: color 0.3s ease;
        }
        .read-more-small:hover {
            color: #1e3a8a;
        }
        .read-more-small i {
            margin-left: 0.4rem;
            transition: transform 0.3s ease;
        }
        .read-more-small:hover i {
            transform: translateX(3px);
        }
        /* Category Tags */
        .category-tag {
            display: inline-block;
            background-color: #dbeafe;
            color: #1e40af;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-100 font-roboto" onload="myFunction()">
    <header class="bg-white shadow" role="banner">
        <div class="bg-blue-600 text-white py-2">
            <div class="container mx-auto px-4 flex justify-end">
                <a href="https://chat.whatsapp.com/EkDQiiIS9SYHg8HEZ7cVZ6" target="_blank" class="hover:underline" aria-label="Join Kageyo TVET School WhatsApp Group">
                    <i class="fab fa-whatsapp mr-2" aria-hidden="true"></i>Join WhatsApp Group
                </a>
            </div>
        </div>
        <div class="container mx-auto px-4 py-4">
            <nav class="flex flex-wrap items-center justify-between" role="navigation" aria-label="Main navigation">
                <div class="flex items-center space-x-4">
                    <a href="index.html" aria-label="Kageyo TVET School Home">
                        <img src="logo.jpg" alt="Kageyo TVET School Logo" class="w-20 h-20">
                    </a>
                    <div>
                        <h1>
                            <a href="index.html" class="text-2xl font-bold text-blue-600">KAGEYO TVET SCHOOL</a>
                        </h1>
                        <p class="text-sm text-gray-500">WORK - COURAGE - SOLIDARITY</p>
                    </div>
                </div>
                <button class="md:hidden text-blue-600" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="navbar" onclick="toggleNav()">
                    <i class="fas fa-bars" aria-hidden="true"></i>
                    <span class="sr-only">Toggle menu</span>
                </button>
                <div id="navbar" class="hidden md:flex md:items-center w-full md:w-auto mt-4 md:mt-0" role="menu">
                    <ul class="flex flex-col md:flex-row md:space-x-6 w-full md:w-auto">
                        <li><a href="index.html" class="block py-2 text-blue-600 hover:text-blue-800" role="menuitem">Home</a></li>
                        <li><a href="about.html" class="block py-2 text-blue-600 hover:text-blue-800" role="menuitem">About Us</a></li>
                        <li><a href="apply job.html" class="block py-2 text-blue-600 hover:text-blue-800" role="menuitem">Apply for a Job</a></li>
                        <li class="relative dropdown">
                            <button class="block py-2 text-blue-600 hover:text-blue-800 flex items-center" aria-expanded="false" aria-controls="admin-menu" onclick="toggleDropdown('admin-menu')" role="menuitem">
                                Administration <i class="fas fa-chevron-down ml-2" aria-hidden="true"></i>
                                <span class="sr-only">Toggle Administration submenu</span>
                            </button>
                            <ul id="admin-menu" class="dropdown-menu bg-white shadow-lg mt-2 rounded-md w-48" role="menu">
                                <li><a href="staff.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Staff</a></li>
                            </ul>
                        </li>
                        <li><a href="trainers.html" class="block py-2 text-blue-600 hover:text-blue-800" role="menuitem">Trainers</a></li>
                        <li><a href="trades.html" class="block py-2 text-blue-600 hover:text-blue-800" role="menuitem">Trades</a></li>
                        <li class="relative dropdown">
                            <button class="block py-2 text-blue-600 hover:text-blue-800 flex items-center" aria-expanded="false" aria-controls="more-menu" onclick="toggleDropdown('more-menu')" role="menuitem">
                                More <i class="fas fa-chevron-down ml-2" aria-hidden="true"></i>
                                <span class="sr-only">Toggle More submenu</span>
                            </button>
                            <ul id="more-menu" class="dropdown-menu bg-white shadow-lg mt-2 rounded-md w-48" role="menu">
                                <li><a href="news.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">News</a></li>
                                <li><a href="events.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Events</a></li>
                                <li><a href="announcements.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Announcements</a></li>
                                <li><a href="best-performers.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Best Performers</a></li>
                                <li><a href="head-teacher.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Head Teacher</a></li>
                                <li><a href="student-papers.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Student Papers</a></li>
                                <li><a href="employee-of-the-year.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Employee of the Year</a></li>
                                <li><a href="forum.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Forum</a></li>
                                <li><a href="developers.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Developers</a></li>
                                <li><a href="student-projects.html" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" role="menuitem">Student Projects</a></li>
                            </ul>
                        </li>
                        <li><a href="contact.html" class="block py-2 text-blue-600 hover:text-blue-800" role="menuitem">Contact</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>

    <!-- Admin Panel (Hidden by default) -->
    <div id="admin-overlay"></div>
    <div id="admin-panel">
        <h2 class="text-2xl font-bold text-blue-600 mb-4">Admin Login</h2>
        <div class="mb-4">
            <label for="admin-password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
            <input type="password" id="admin-password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter admin password">
        </div>
        <div class="flex space-x-2">
            <button onclick="adminLogin()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex-1">Login</button>
            <button onclick="closeAdminPanel()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 flex-1">Cancel</button>
        </div>
    </div>

    <!-- Admin Controls (Visible after login) -->
    <div id="admin-controls" class="hidden bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-4">
        <div class="container mx-auto max-w-7xl px-4">
            <div class="flex justify-between items-center">
                <p class="text-yellow-700 font-semibold">Admin Mode Active</p>
                <div class="space-x-2">
                    <button onclick="showEditArticleForm()" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">Edit Article</button>
                    <button onclick="adminLogout()" class="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700">Logout</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Article Form (Hidden by default) -->
    <div id="edit-article-form" class="hidden bg-white p-6 rounded-lg shadow-lg mb-8">
        <div class="container mx-auto max-w-7xl px-4">
            <h3 class="text-xl font-bold text-blue-600 mb-4">Edit Article</h3>
            <form id="article-form" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="article-title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                        <input type="text" id="article-title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="article-author" class="block text-sm font-medium text-gray-700 mb-1">Author</label>
                        <input type="text" id="article-author" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                </div>
                <div>
                    <label for="article-date" class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                    <input type="date" id="article-date" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label for="article-image" class="block text-sm font-medium text-gray-700 mb-1">Image URL</label>
                    <input type="url" id="article-image" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/image.jpg">
                </div>
                <div>
                    <label for="article-content" class="block text-sm font-medium text-gray-700 mb-1">Content</label>
                    <textarea id="article-content" rows="10" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required></textarea>
                </div>
                <div>
                    <label for="article-category" class="block text-sm font-medium text-gray-700 mb-1">Category (for related news)</label>
                    <select id="article-category" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="general">General News</option>
                        <option value="academic">Academic</option>
                        <option value="events">Events</option>
                        <option value="students">Student Achievements</option>
                        <option value="faculty">Faculty News</option>
                        <option value="programs">Program Updates</option>
                        <option value="partnerships">Partnerships</option>
                        <option value="community">Community Engagement</option>
                    </select>
                </div>
                <div class="flex space-x-2">
                    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">Update Article</button>
                    <button type="button" onclick="hideEditArticleForm()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600">Cancel</button>
                    <button type="button" onclick="deleteCurrentArticle()" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700">Delete Article</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Promotional Banner -->
    <section class="bg-blue-600 text-white py-8 fade-in" aria-label="Promotional banner">
        <div class="container mx-auto px-4 max-w-7xl text-center">
            <h2 class="text-2xl font-bold mb-4">Explore Our Trades!</h2>
            <p class="mb-4">Discover programs like Software Development, Accounting, and more. Join Kageyo TVET School today!</p>
            <a href="trades.html" class="inline-block bg-white text-blue-600 font-bold py-2 px-4 rounded hover:bg-gray-100" aria-label="Learn more about our trades">Learn More</a>
        </div>
    </section>

    <main role="main">
        <section class="py-16 bg-white" aria-label="News Article">
            <div class="container mx-auto max-w-7xl px-4">
                <div class="mb-12">
                    <h1 class="text-3xl font-bold text-blue-600 mb-2" id="article-title">News Article</h1>
                    <div class="flex space-x-2 text-sm text-gray-600">
                        <a href="index.html" class="hover:text-blue-600" aria-label="Go to Home page">Home</a>
                        <span>/</span>
                        <a href="news.html" class="hover:text-blue-600" aria-label="Go to News page">News</a>
                        <span>/</span>
                        <span id="article-breadcrumb" aria-current="page">Article</span>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                    <div class="lg:col-span-2">
                        <div class="bg-white shadow rounded-lg overflow-hidden">
                            <div class="p-6">
                                <img id="article-image" src="kt.jpg" alt="News article image" class="w-full h-80 object-cover rounded">
                            </div>
                            <div class="p-6">
                                <div class="flex flex-wrap mb-4" id="article-categories">
                                    <!-- Categories will be dynamically loaded here -->
                                </div>
                                <p class="text-sm text-gray-500" id="article-date">Posted: May 2025</p>
                                <h2 class="text-2xl font-bold text-blue-600 mb-4" id="article-heading">Birabujijwe kwambuka umuhanda utanyuze ahabugenewe (Zebra crossing)</h2>
                                <div id="article-content" class="text-gray-600 mb-4">
                                    <p>Loading article content...</p>
                                </div>
                                <div class="flex justify-between items-center">
                                    <p class="text-sm text-gray-500" id="article-author">By: Author Name</p>
                                    <div class="flex space-x-2">
                                        <a href="news.html" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center" aria-label="Back to News page">
                                            Back to News <i class="fas fa-arrow-left ml-2" aria-hidden="true"></i>
                                        </a>
                                        <!-- Admin Access Button -->
                                        <button onclick="openAdminPanel()" class="bg-blue-600 text-white px-3 py-2 rounded-md hover:bg-blue-700 flex items-center">
                                            <i class="fas fa-lock mr-1" aria-hidden="true"></i> Admin
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Related News Section -->
                        <div class="mt-12">
                            <h3 class="text-2xl font-bold text-blue-600 mb-6">Related News</h3>
                            <div id="related-news" class="related-news-grid">
                                <!-- Related news will be dynamically loaded here -->
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-1">
                        <div class="bg-gray-50 p-6 rounded-lg shadow">
                            <h3 class="text-xl font-bold text-blue-600 mb-4">Recent Posts</h3>
                            <div id="recent-posts">
                                <!-- Recent posts will be dynamically loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-blue-900 text-white py-12" role="contentinfo">
        <div class="container mx-auto max-w-7xl px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h2><a href="index.html" class="text-2xl font-bold" aria-label="Kageyo TVET School Home">Kageyo TVET School</a></h2>
                    <p class="mt-2">Work - Courage - Solidarity</p>
                    <p class="mt-2">
                        Northern Province<br>
                        Gicumbi District<br>
                        Kaniga Sector
                    </p>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Useful Links</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="hover:underline" aria-label="Go to Home page">Home</a></li>
                        <li><a href="about.html" class="hover:underline" aria-label="Go to About Us page">About Us</a></li>
                        <li><a href="news.html" class="hover:underline" aria-label="Go to News page">News</a></li>
                        <li><a href="trades.html" class="hover:underline" aria-label="Go to Trades page">Trades</a></li>
                        <li><a href="contact.html" class="hover:underline" aria-label="Go to Contact page">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Information</h3>
                    <ul class="space-y-2">
                        <li><a href="developers.html" class="hover:underline" aria-label="Go to Developers page">Developers</a></li>
                        <li><a href="student-projects.html" class="hover:underline" aria-label="Go to Student Projects page">Student Projects</a></li>
                    </ul>
                    <!-- Admin Access Button in Footer -->
                    <div class="mt-4">
                        <button onclick="openAdminPanel()" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 flex items-center">
                            <i class="fas fa-lock mr-1" aria-hidden="true"></i> Admin Access
                        </button>
                    </div>
                </div>
            </div>
            <div class="mt-8 text-center">
                <p>© Kageyo TVET School 2025</p>
            </div>
        </div>
    </footer>

    <section id="scroll-top" class="fixed bottom-4 right-4 hidden" aria-label="Scroll to top">
        <button class="bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700" aria-label="Scroll to top of page">
            <i class="fas fa-arrow-up" aria-hidden="true"></i>
        </button>
    </section>

    <section id="chatbot" class="fixed bottom-4 right-16" aria-label="Chatbot">
        <button id="chatbot-toggle" class="bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700" aria-label="Toggle chat window" aria-expanded="false" aria-controls="chatbot-window">
            <i class="fas fa-comment-dots" aria-hidden="true"></i>
            <span class="sr-only">Open chat</span>
        </button>
        <div id="chatbot-window" role="dialog" aria-label="Chat with Kageyo TVET School assistant">
            <div id="chatbot-header">
                <span>Kageyo TVET Assistant</span>
                <button id="chatbot-close" class="text-white hover:text-gray-200" aria-label="Close chat window">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div id="chatbot-messages" aria-live="polite">
                <div class="chatbot-bot-message">Hi! I'm thrilled to help you explore Kageyo TVET School's latest news, like our Tech Innovation Fair or new Welding Program! Ask about news, salaries, registration, or anything else, and I'll guide you with a smile!</div>
            </div>
            <div class="p-2">
                <input id="chatbot-input" type="text" placeholder="Share your question or worry, I'm all ears!" aria-label="Type your question or concern">
                <button id="chatbot-send" class="bg-blue-600 text-white px-4 py-2 mt-2 rounded hover:bg-blue-700" aria-label="Send message">Send</button>
            </div>
        </div>
    </section>

    <div id="loader" class="text-center" aria-live="polite">Loading site</div>

    <script>
        // Admin password (in production, this should be stored securely on a server)
        const ADMIN_PASSWORD = "kageyo2025";
        
        // Current article ID
        let currentArticleId = null;

        // Enhanced news data with categories for better related content matching
        let newsData = JSON.parse(localStorage.getItem('kageyoNews')) || [
            {
                id: "tech-fair-2025",
                title: "Guv @NyirarugeroD arimo gusura ibikorwaremezo",
                date: "2025-05-18",
                author: "SHYAKA CLEVER PRINCE",
                image: "1.jpg",
                content: "Kuri uyu munsi, Guv @NyirarugeroD arimo gusura ibikorwaremezo, birimo G.S Kageyo n'Ikigo Nderabuzima cya Gihembe, biri mu Murenge wa Kageyo/ Gicumbi, byari bisanzwe byifashishwa mu guha serivisi impunzi zo mu Nkambi ya Gihembe, hagamijwe kureba uburyo byakomeza kubyazwa umusaruro",
                type: "news",
                categories: ["events", "community"]
            },
            {
                id: "welding-program-2025",
                title: "bimwe by'ingenzi umunyamaguru agomba kwitaho harimo",
                date: "2025-05-15",
                author: "Shyaka clever Prince",
                image: "2.jpg",
                content: "KAGEYO TVET @KageyoT · Oct 26, 2022 1/3 Ejo kuwa 25 ukwakira 2022 muri @KageyoT twasuwe na @Rwandapolice ishami rishinzwe umutekano wo mu muhanda mu Karere ka @GicumbiDistrict Aho twize uko bakoresha umuhanda neza #Roadsafety ndetse twibutswa neza ibyo umunyamaguru agomba kwitaho mbere yo kwambuka umuhanda.",
                type: "news",
                categories: ["academic", "programs"]
            },
            {
                id: "alumni-success-2025",
                title: "wikki club: wikkimedia club",
                date: "2025-05-12",
                author: "Marie Claire Ingabire",
                image: "wikki.jpg",
                content: "A Kageyo TVET launches the wikkimedia club to promote their skillsin our training programs.",
                type: "news",
                categories: ["students", "programs"]
            },
            {
                id: "software-development-2025",
                title: "New Software Development Department at Kageyo TVET",
                date: "2025-05-18",
                author: "SHYAKA CLEVER PRINCE",
                image: "sod.jpg",
                content: "Kageyo TVET School has established a new Software Development department to meet the growing demand for digital skills in Rwanda's economy.",
                type: "news",
                categories: ["programs", "academic"]
            },
            {
                id: "community-cleanup-2025",
                title: "Kageyo TVET Leads Community Clean-Up Day",
                date: "2025-05-10",
                author: "Jean Paul Niyonzima",
                image: "images/community_cleanup_2025.jpg",
                content: "Students and staff from Kageyo TVET School united for a community clean-up in Kaniga Sector, promoting environmental responsibility and community engagement.",
                type: "news",
                categories: ["community", "students"]
            },
            {
                id: "teacher-training-2025",
                title: "Teacher Training Workshop Enhances Skills",
                date: "2025-05-08",
                author: "Shyaka Clever Prince",
                image: "images/teacher_training_2025.jpg",
                content: "Kageyo TVET trainers attended a comprehensive workshop to adopt modern teaching methods, boosting classroom engagement and learning outcomes.",
                type: "news",
                categories: ["faculty", "academic"]
            }
        ];

        // YouTube Shorts data
        let shortsData = JSON.parse(localStorage.getItem('kageyoShorts')) || [
            {
                id: "software-short-2025",
                title: "Coding Basics in Kinyarwanda",
                date: "2025-05-20",
                author: "Jean de Dieu Nsengiyumva",
                image: "images/software_short_2025.jpg",
                content: "Learn the basics of software development with our easy-to-follow YouTube Short in Kinyarwanda.",
                type: "short",
                categories: ["programs", "academic"]
            },
            {
                id: "networking-short-2025",
                title: "Setting Up a Router",
                date: "2025-05-20",
                author: "Marie Rose Uwamahoro",
                image: "images/networking_short_2025.jpg",
                content: "A quick guide to configuring a router, presented in our latest YouTube Short.",
                type: "short",
                categories: ["programs", "academic"]
            },
            {
                id: "welding-short-2025",
                title: "Intro to Welding Safety",
                date: "2025-05-20",
                author: "Paul Niyigena",
                image: "images/welding_short_2025.jpg",
                content: "Discover essential welding safety tips in our new YouTube Short, perfect for beginners.",
                type: "short",
                categories: ["programs", "academic"]
            }
        ];

        // Function to save data to localStorage
        function saveData() {
            localStorage.setItem('kageyoNews', JSON.stringify(newsData));
            localStorage.setItem('kageyoShorts', JSON.stringify(shortsData));
        }

        // Function to get URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Function to find related articles based on categories and content similarity
        function findRelatedArticles(currentArticleId, currentArticleCategories) {
            // Get all articles
            const allArticles = [...newsData, ...shortsData];
            
            // Filter out current article
            const otherArticles = allArticles.filter(article => article.id !== currentArticleId);
            
            // Score articles based on relevance
            const scoredArticles = otherArticles.map(article => {
                let score = 0;
                
                // Category matching (highest weight)
                if (article.categories && currentArticleCategories) {
                    const commonCategories = article.categories.filter(cat => 
                        currentArticleCategories.includes(cat)
                    );
                    score += commonCategories.length * 10;
                }
                
                // Content similarity (medium weight)
                const currentContent = allArticles.find(a => a.id === currentArticleId)?.content || '';
                const articleContent = article.content || '';
                
                // Simple keyword matching
                const currentKeywords = currentContent.toLowerCase().split(/\s+/);
                const articleKeywords = articleContent.toLowerCase().split(/\s+/);
                
                const commonKeywords = currentKeywords.filter(keyword => 
                    articleKeywords.includes(keyword) && keyword.length > 3
                );
                score += commonKeywords.length * 2;
                
                // Recency bonus (lower weight)
                const currentDate = new Date(allArticles.find(a => a.id === currentArticleId)?.date || '');
                const articleDate = new Date(article.date || '');
                const daysDifference = Math.abs((currentDate - articleDate) / (1000 * 60 * 60 * 24));
                
                if (daysDifference < 30) {
                    score += 5; // Recent articles get bonus
                }
                
                return {
                    ...article,
                    relevanceScore: score
                };
            });
            
            // Sort by relevance score and return top 6
            return scoredArticles
                .sort((a, b) => b.relevanceScore - a.relevanceScore)
                .slice(0, 6);
        }

        // Function to load article based on ID
        function loadArticle() {
            const articleId = getUrlParameter('id');
            currentArticleId = articleId;
            
            // Get news data from localStorage
            const newsData = JSON.parse(localStorage.getItem('kageyoNews')) || [];
            const shortsData = JSON.parse(localStorage.getItem('kageyoShorts')) || [];
            
            // Combine news and shorts data
            const allArticles = [...newsData, ...shortsData];
            
            // Find the article
            const article = allArticles.find(item => item.id === articleId);
            
            if (article) {
                // Update page elements with article data
                document.getElementById('article-title').textContent = article.title;
                document.getElementById('article-breadcrumb').textContent = article.title;
                document.getElementById('article-image').src = article.image;
                document.getElementById('article-image').alt = article.title;
                
                const formattedDate = new Date(article.date).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                document.getElementById('article-date').textContent = `Posted: ${formattedDate}`;
                document.getElementById('article-heading').textContent = article.title;
                document.getElementById('article-content').innerHTML = `<p>${article.content}</p>`;
                document.getElementById('article-author').textContent = `By: ${article.author}`;
                
                // Load categories
                loadArticleCategories(article.categories);
                
                // Update page title
                document.title = `Kageyo TVET School | ${article.title}`;
                
                // Load related news based on categories and content
                loadRelatedNews(articleId, article.categories);
            } else {
                // Article not found, show default content
                document.getElementById('article-title').textContent = 'Article Not Found';
                document.getElementById('article-breadcrumb').textContent = 'Article Not Found';
                document.getElementById('article-heading').textContent = 'Article Not Found';
                document.getElementById('article-content').innerHTML = '<p>The requested article could not be found. Please check the URL or return to the news page.</p>';
                document.getElementById('article-author').textContent = 'By: Unknown';
            }
        }

        // Function to load article categories
        function loadArticleCategories(categories) {
            const categoriesContainer = document.getElementById('article-categories');
            
            if (categories && categories.length > 0) {
                let html = '';
                categories.forEach(category => {
                    const categoryName = getCategoryDisplayName(category);
                    html += `<span class="category-tag">${categoryName}</span>`;
                });
                categoriesContainer.innerHTML = html;
            } else {
                categoriesContainer.innerHTML = '<span class="category-tag">General News</span>';
            }
        }

        // Function to get display name for categories
        function getCategoryDisplayName(category) {
            const categoryMap = {
                'general': 'General News',
                'academic': 'Academic',
                'events': 'Events',
                'students': 'Student Achievements',
                'faculty': 'Faculty News',
                'programs': 'Program Updates',
                'partnerships': 'Partnerships',
                'community': 'Community Engagement'
            };
            return categoryMap[category] || category;
        }

        // Function to load related news
        function loadRelatedNews(currentArticleId, currentArticleCategories) {
            const relatedNewsContainer = document.getElementById('related-news');
            
            // Find related articles
            const relatedArticles = findRelatedArticles(currentArticleId, currentArticleCategories);
            
            if (relatedArticles.length > 0) {
                let html = '';
                relatedArticles.forEach(article => {
                    const formattedDate = new Date(article.date).toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric',
                        year: 'numeric'
                    });
                    
                    // Get first category for display
                    const primaryCategory = article.categories && article.categories.length > 0 
                        ? article.categories[0] 
                        : 'general';
                    
                    html += `
                        <div class="related-news-card">
                            <img src="${article.image}" alt="${article.title}" class="related-news-image">
                            <div class="related-news-content">
                                <span class="category-tag">${getCategoryDisplayName(primaryCategory)}</span>
                                <a href="readmore.html?id=${article.id}" class="related-news-title">${article.title}</a>
                                <p class="related-news-date">${formattedDate}</p>
                                <p class="related-news-excerpt">${article.content.substring(0, 120)}...</p>
                                <a href="readmore.html?id=${article.id}" class="read-more-small" aria-label="Read more about ${article.title}">
                                    Read More <i class="fas fa-arrow-right" aria-hidden="true"></i>
                                </a>
                            </div>
                        </div>
                    `;
                });
                
                relatedNewsContainer.innerHTML = html;
            } else {
                relatedNewsContainer.innerHTML = `
                    <div class="col-span-full text-center py-8">
                        <p class="text-gray-500">No related articles found. Check out our recent news below.</p>
                        <a href="news.html" class="inline-block mt-4 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            View All News
                        </a>
                    </div>
                `;
            }
        }

        // Function to load recent posts
        function loadRecentPosts() {
            const recentPostsContainer = document.getElementById('recent-posts');
            
            // Get news data from localStorage
            const newsData = JSON.parse(localStorage.getItem('kageyoNews')) || [];
            const shortsData = JSON.parse(localStorage.getItem('kageyoShorts')) || [];
            
            // Combine and sort by date (newest first)
            const allArticles = [...newsData, ...shortsData]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5); // Get latest 5
            
            let html = '';
            allArticles.forEach(article => {
                const formattedDate = new Date(article.date).toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric',
                    year: 'numeric'
                });
                
                html += `
                    <div class="flex space-x-4 mb-4">
                        <img src="${article.image}" alt="${article.title}" class="w-24 h-24 object-cover rounded">
                        <div>
                            <a href="readmore.html?id=${article.id}" class="text-blue-600 hover:underline" aria-label="Read more about ${article.title}">${article.title}</a>
                            <p class="text-sm text-gray-500 mt-1">${formattedDate}</p>
                        </div>
                    </div>
                `;
            });
            
            recentPostsContainer.innerHTML = html;
        }

        // Admin functions
        function openAdminPanel() {
            document.body.classList.add('admin-active');
        }

        function closeAdminPanel() {
            document.body.classList.remove('admin-active');
            document.getElementById('admin-password').value = '';
        }

        function adminLogin() {
            const password = document.getElementById('admin-password').value;
            if (password === ADMIN_PASSWORD) {
                localStorage.setItem('kageyoAdmin', 'true');
                document.getElementById('admin-controls').classList.remove('hidden');
                closeAdminPanel();
            } else {
                alert('Invalid password. Please try again.');
            }
        }

        function adminLogout() {
            localStorage.removeItem('kageyoAdmin');
            document.getElementById('admin-controls').classList.add('hidden');
            hideEditArticleForm();
        }

        function isAdminLoggedIn() {
            return localStorage.getItem('kageyoAdmin') === 'true';
        }

        function showEditArticleForm() {
            if (!currentArticleId) return;
            
            // Get news data from localStorage
            const newsData = JSON.parse(localStorage.getItem('kageyoNews')) || [];
            const shortsData = JSON.parse(localStorage.getItem('kageyoShorts')) || [];
            
            // Combine news and shorts data
            const allArticles = [...newsData, ...shortsData];
            
            // Find the article
            const article = allArticles.find(item => item.id === currentArticleId);
            
            if (article) {
                document.getElementById('article-title').value = article.title;
                document.getElementById('article-author').value = article.author;
                document.getElementById('article-date').value = article.date;
                document.getElementById('article-image').value = article.image;
                document.getElementById('article-content').value = article.content;
                
                // Set category if exists
                if (article.categories && article.categories.length > 0) {
                    document.getElementById('article-category').value = article.categories[0];
                }
                
                document.getElementById('edit-article-form').classList.remove('hidden');
            }
        }

        function hideEditArticleForm() {
            document.getElementById('edit-article-form').classList.add('hidden');
        }

        // Handle article form submission
        document.getElementById('article-form').addEventListener('submit', function(e) {
            e.preventDefault();
            updateArticle();
        });

        function updateArticle() {
            if (!currentArticleId) return;
            
            const title = document.getElementById('article-title').value;
            const author = document.getElementById('article-author').value;
            const date = document.getElementById('article-date').value;
            const image = document.getElementById('article-image').value || 'images/default-news.jpg';
            const content = document.getElementById('article-content').value;
            const category = document.getElementById('article-category').value;
            
            // Get news data from localStorage
            let newsData = JSON.parse(localStorage.getItem('kageyoNews')) || [];
            let shortsData = JSON.parse(localStorage.getItem('kageyoShorts')) || [];
            
            // Find and update the article in news data
            let articleUpdated = false;
            
            // Check in news data
            const newsIndex = newsData.findIndex(item => item.id === currentArticleId);
            if (newsIndex !== -1) {
                newsData[newsIndex] = {
                    id: currentArticleId,
                    title,
                    date,
                    author,
                    image,
                    content,
                    type: "news",
                    categories: [category]
                };
                articleUpdated = true;
            }
            
            // Check in shorts data
            const shortsIndex = shortsData.findIndex(item => item.id === currentArticleId);
            if (shortsIndex !== -1) {
                shortsData[shortsIndex] = {
                    id: currentArticleId,
                    title,
                    date,
                    author,
                    image,
                    content,
                    type: "short",
                    categories: [category]
                };
                articleUpdated = true;
            }
            
            if (articleUpdated) {
                // Save to localStorage
                localStorage.setItem('kageyoNews', JSON.stringify(newsData));
                localStorage.setItem('kageyoShorts', JSON.stringify(shortsData));
                
                // Reload article
                loadArticle();
                
                // Hide form
                hideEditArticleForm();
                
                alert('Article updated successfully!');
            } else {
                alert('Error: Article not found for updating.');
            }
        }

        function deleteCurrentArticle() {
            if (!currentArticleId || !confirm('Are you sure you want to delete this article?')) {
                return;
            }
            
            // Get news data from localStorage
            let newsData = JSON.parse(localStorage.getItem('kageyoNews')) || [];
            let shortsData = JSON.parse(localStorage.getItem('kageyoShorts')) || [];
            
            // Remove the article from both news and shorts data
            newsData = newsData.filter(item => item.id !== currentArticleId);
            shortsData = shortsData.filter(item => item.id !== currentArticleId);
            
            // Save to localStorage
            localStorage.setItem('kageyoNews', JSON.stringify(newsData));
            localStorage.setItem('kageyoShorts', JSON.stringify(shortsData));
            
            // Redirect to news page
            window.location.href = 'news.html';
        }

        // Initialize page
        function initializePage() {
            loadArticle();
            loadRecentPosts();
            
            // Check if admin is logged in
            if (isAdminLoggedIn()) {
                document.getElementById('admin-controls').classList.remove('hidden');
            }
        }

        // Run initialization when DOM is loaded
        document.addEventListener('DOMContentLoaded', initializePage);

        // Rest of your existing JavaScript functions...
        function myFunction() {
            setTimeout(showPage, 3000);
        }

        function showPage() {
            document.getElementById("loader").style.display = "none";
            document.getElementById("scroll-top").style.display = "block";
        }

        function toggleNav() {
            const nav = document.getElementById("navbar");
            const button = document.querySelector("button[aria-controls='navbar']");
            const isExpanded = nav.classList.toggle("hidden");
            button.setAttribute("aria-expanded", !isExpanded);
        }

        function toggleDropdown(menuId) {
            const menu = document.getElementById(menuId);
            const button = document.querySelector(`button[aria-controls="${menuId}"]`);
            const isExpanded = menu.classList.toggle("active");
            button.setAttribute("aria-expanded", isExpanded);
        }

        // Chatbot functionality
        document.getElementById('chatbot-toggle').addEventListener('click', function() {
            const chatbotWindow = document.getElementById('chatbot-window');
            const isActive = chatbotWindow.classList.toggle('active');
            this.setAttribute('aria-expanded', isActive);
        });

        document.getElementById('chatbot-close').addEventListener('click', function() {
            document.getElementById('chatbot-window').classList.remove('active');
            document.getElementById('chatbot-toggle').setAttribute('aria-expanded', 'false');
        });

        document.getElementById('chatbot-send').addEventListener('click', sendMessage);
        document.getElementById('chatbot-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        function sendMessage() {
            const input = document.getElementById('chatbot-input');
            const message = input.value.trim();
            if (message === '') return;

            // Add user message
            const messagesContainer = document.getElementById('chatbot-messages');
            const userMessage = document.createElement('div');
            userMessage.className = 'chatbot-user-message';
            userMessage.textContent = message;
            messagesContainer.appendChild(userMessage);

            // Clear input
            input.value = '';

            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Generate bot response
            setTimeout(() => {
                const botMessage = document.createElement('div');
                botMessage.className = 'chatbot-bot-message';
                
                // Simple response logic
                let response = "Thank you for your message! For more information, please visit our website or contact us directly.";
                if (message.toLowerCase().includes('news')) {
                    response = "We have exciting news about our programs and events! Check our news section for the latest updates.";
                } else if (message.toLowerCase().includes('program') || message.toLowerCase().includes('course')) {
                    response = "We offer various programs including Software Development, Networking, and Welding. Visit our Trades page for details.";
                } else if (message.toLowerCase().includes('contact') || message.toLowerCase().includes('where')) {
                    response = "We're located in Gicumbi District, Kaniga Sector. You can call us at 0788521465 or visit our Contact page.";
                } else if (message.toLowerCase().includes('apply') || message.toLowerCase().includes('join')) {
                    response = "To apply, visit our 'Apply for a Job' page or contact us directly. We'd love to have you join our community!";
                }
                
                botMessage.textContent = response;
                messagesContainer.appendChild(botMessage);
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 1000);
        }

        // Scroll to top functionality
        window.addEventListener('scroll', function() {
            const scrollTop = document.getElementById('scroll-top');
            if (window.pageYOffset > 300) {
                scrollTop.style.display = 'block';
            } else {
                scrollTop.style.display = 'none';
            }
        });

        document.getElementById('scroll-top').addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>